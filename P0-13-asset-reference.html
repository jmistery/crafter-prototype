<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P0-13: 地址化引用资产库素材</title>
    <!-- Element UI CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- Element UI JS -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background-color: #f5f7fa;
        }
        
        .asset-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .page-header {
            margin-bottom: 30px;
        }
        
        .page-header h1 {
            margin: 0 0 10px 0;
            font-size: 28px;
            color: #303133;
        }
        
        .page-header p {
            margin: 0;
            color: #909399;
            font-size: 14px;
        }
        
        /* 资产库布局 */
        .asset-layout {
            display: flex;
            gap: 20px;
        }
        
        .asset-sidebar {
            width: 250px;
            flex-shrink: 0;
        }
        
        .asset-main {
            flex: 1;
        }
        
        /* 资产卡片网格 */
        .asset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .asset-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .asset-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .asset-card.selected {
            border-color: #409EFF;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.2);
        }
        
        .asset-thumbnail {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background-color: #f5f7fa;
        }
        
        .asset-info {
            padding: 12px;
        }
        
        .asset-name {
            font-size: 14px;
            font-weight: 500;
            margin: 0 0 5px 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .asset-meta {
            font-size: 12px;
            color: #909399;
            display: flex;
            justify-content: space-between;
        }
        
        .asset-actions {
            padding: 8px 12px;
            border-top: 1px solid #ebeef5;
            display: flex;
            gap: 5px;
        }
        
        /* 资产详情面板 */
        .asset-detail-drawer .el-drawer__body {
            padding: 20px;
        }
        
        .detail-preview {
            width: 100%;
            max-height: 400px;
            object-fit: contain;
            background-color: #f5f7fa;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .detail-section {
            margin-bottom: 25px;
        }
        
        .detail-section h3 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: #303133;
        }
        
        .detail-item {
            margin-bottom: 12px;
        }
        
        .detail-label {
            color: #909399;
            font-size: 13px;
            margin-bottom: 5px;
        }
        
        .detail-value {
            color: #303133;
            font-size: 14px;
        }
        
        .url-copy-box {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .url-display {
            flex: 1;
            padding: 8px 12px;
            background-color: #f5f7fa;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #606266;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* 资产引用列表 */
        .reference-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .reference-item {
            padding: 12px;
            background-color: #f5f7fa;
            border-radius: 4px;
            margin-bottom: 8px;
        }
        
        .reference-item-title {
            font-size: 14px;
            font-weight: 500;
            color: #303133;
            margin-bottom: 5px;
        }
        
        .reference-item-meta {
            font-size: 12px;
            color: #909399;
        }
        
        /* 上传区域 */
        .upload-area {
            border: 2px dashed #d9d9d9;
            border-radius: 8px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background-color: white;
        }
        
        .upload-area:hover {
            border-color: #409EFF;
            background-color: #f0f9ff;
        }
        
        .upload-icon {
            font-size: 64px;
            color: #c0c4cc;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 16px;
            color: #606266;
            margin-bottom: 10px;
        }
        
        .upload-tip {
            font-size: 13px;
            color: #909399;
        }
        
        /* 版本历史 */
        .version-timeline {
            padding: 20px 0;
        }
        
        .version-item {
            position: relative;
            padding-left: 30px;
            padding-bottom: 20px;
        }
        
        .version-item::before {
            content: '';
            position: absolute;
            left: 7px;
            top: 8px;
            bottom: -12px;
            width: 2px;
            background-color: #e4e7ed;
        }
        
        .version-item:last-child::before {
            display: none;
        }
        
        .version-dot {
            position: absolute;
            left: 0;
            top: 0;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #409EFF;
            border: 3px solid white;
            box-shadow: 0 0 0 2px #409EFF;
        }
        
        .version-content {
            background-color: #f5f7fa;
            padding: 12px;
            border-radius: 4px;
        }
        
        .version-name {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .version-info {
            font-size: 12px;
            color: #909399;
        }
        
        @media (max-width: 1200px) {
            .asset-layout {
                flex-direction: column;
            }
            
            .asset-sidebar {
                width: 100%;
            }
            
            .asset-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="asset-container">
            <!-- 页面头部 -->
            <div class="page-header">
                <h1>资产库管理</h1>
                <p>统一管理和引用所有媒体资源，支持地址化引用和版本控制</p>
            </div>
            
            <!-- 资产库布局 -->
            <div class="asset-layout">
                <!-- 左侧筛选栏 -->
                <div class="asset-sidebar">
                    <el-card>
                        <div slot="header">
                            <strong>筛选条件</strong>
                        </div>
                        
                        <el-form label-position="top">
                            <el-form-item label="资产类型">
                                <el-select v-model="filterType" placeholder="全部类型" style="width: 100%;">
                                    <el-option label="全部" value="all"></el-option>
                                    <el-option label="图片" value="image"></el-option>
                                    <el-option label="视频" value="video"></el-option>
                                    <el-option label="文档" value="document"></el-option>
                                </el-select>
                            </el-form-item>
                            
                            <el-form-item label="标签">
                                <el-select v-model="filterTags" multiple placeholder="选择标签" style="width: 100%;">
                                    <el-option label="产品" value="product"></el-option>
                                    <el-option label="Banner" value="banner"></el-option>
                                    <el-option label="物流" value="logistics"></el-option>
                                    <el-option label="零售" value="retail"></el-option>
                                    <el-option label="2024" value="2024"></el-option>
                                </el-select>
                            </el-form-item>
                            
                            <el-form-item label="上传时间">
                                <el-date-picker
                                    v-model="dateRange"
                                    type="daterange"
                                    range-separator="至"
                                    start-placeholder="开始日期"
                                    end-placeholder="结束日期"
                                    size="small"
                                    style="width: 100%;">
                                </el-date-picker>
                            </el-form-item>
                            
                            <el-button type="primary" size="small" style="width: 100%;" @click="applyFilters">
                                应用筛选
                            </el-button>
                            <el-button size="small" style="width: 100%; margin-top: 10px;" @click="resetFilters">
                                重置
                            </el-button>
                        </el-form>
                    </el-card>
                    
                    <el-card style="margin-top: 20px;">
                        <div slot="header">
                            <strong>存储统计</strong>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 12px; color: #909399; margin-bottom: 5px;">已使用存储</div>
                            <el-progress :percentage="storageUsagePercent" :color="storageColor"></el-progress>
                            <div style="font-size: 12px; color: #606266; margin-top: 5px;">
                                {{ storageUsed }} / {{ storageTotal }}
                            </div>
                        </div>
                        <el-divider></el-divider>
                        <div>
                            <div style="font-size: 13px; margin-bottom: 8px;">
                                <i class="el-icon-picture" style="color: #409EFF;"></i>
                                图片: {{ assetStats.images }}
                            </div>
                            <div style="font-size: 13px; margin-bottom: 8px;">
                                <i class="el-icon-video-camera" style="color: #67C23A;"></i>
                                视频: {{ assetStats.videos }}
                            </div>
                            <div style="font-size: 13px;">
                                <i class="el-icon-document" style="color: #E6A23C;"></i>
                                文档: {{ assetStats.documents }}
                            </div>
                        </div>
                    </el-card>
                </div>
                
                <!-- 主内容区 -->
                <div class="asset-main">
                    <el-card>
                        <!-- 工具栏 -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div style="flex: 1; max-width: 400px;">
                                <el-input
                                    v-model="searchKeyword"
                                    placeholder="搜索资产名称、标签..."
                                    prefix-icon="el-icon-search"
                                    clearable
                                    @keyup.enter.native="handleSearch">
                                </el-input>
                            </div>
                            
                            <div style="display: flex; gap: 10px;">
                                <el-button icon="el-icon-upload" type="primary" @click="uploadDialogVisible = true">
                                    上传资产
                                </el-button>
                                <el-dropdown @command="handleBatchAction">
                                    <el-button>
                                        批量操作<i class="el-icon-arrow-down el-icon--right"></i>
                                    </el-button>
                                    <el-dropdown-menu slot="dropdown">
                                        <el-dropdown-item command="addTags" icon="el-icon-price-tag">添加标签</el-dropdown-item>
                                        <el-dropdown-item command="download" icon="el-icon-download">批量下载</el-dropdown-item>
                                        <el-dropdown-item command="delete" icon="el-icon-delete">批量删除</el-dropdown-item>
                                    </el-dropdown-menu>
                                </el-dropdown>
                                <el-radio-group v-model="viewMode" size="small">
                                    <el-radio-button label="grid">
                                        <i class="el-icon-s-grid"></i>
                                    </el-radio-button>
                                    <el-radio-button label="list">
                                        <i class="el-icon-s-operation"></i>
                                    </el-radio-button>
                                </el-radio-group>
                            </div>
                        </div>
                        
                        <!-- 已选提示 -->
                        <el-alert
                            v-if="selectedAssets.length > 0"
                            :title="`已选择 ${selectedAssets.length} 个资产`"
                            type="info"
                            :closable="false"
                            show-icon
                            style="margin-bottom: 20px;">
                            <el-button size="mini" @click="clearSelection">清除选择</el-button>
                        </el-alert>
                        
                        <!-- 资产网格视图 -->
                        <div v-if="viewMode === 'grid'" class="asset-grid">
                            <div 
                                v-for="asset in displayedAssets" 
                                :key="asset.id"
                                class="asset-card"
                                :class="{ selected: isSelected(asset.id) }"
                                @click="toggleSelection(asset.id)">
                                
                                <img 
                                    v-if="asset.type === 'image'"
                                    :src="asset.thumbnail" 
                                    :alt="asset.name"
                                    class="asset-thumbnail">
                                
                                <div v-else-if="asset.type === 'video'" class="asset-thumbnail" style="display: flex; align-items: center; justify-content: center; background-color: #f0f2f5;">
                                    <i class="el-icon-video-camera" style="font-size: 48px; color: #909399;"></i>
                                </div>
                                
                                <div v-else class="asset-thumbnail" style="display: flex; align-items: center; justify-content: center; background-color: #f0f2f5;">
                                    <i class="el-icon-document" style="font-size: 48px; color: #909399;"></i>
                                </div>
                                
                                <div class="asset-info">
                                    <div class="asset-name" :title="asset.name">{{ asset.name }}</div>
                                    <div class="asset-meta">
                                        <span>{{ asset.size }}</span>
                                        <span>{{ asset.date }}</span>
                                    </div>
                                </div>
                                
                                <div class="asset-actions" @click.stop>
                                    <el-button 
                                        size="mini" 
                                        icon="el-icon-view"
                                        @click="viewAssetDetail(asset)">
                                    </el-button>
                                    <el-button 
                                        size="mini" 
                                        icon="el-icon-link"
                                        @click="copyAssetUrl(asset)">
                                    </el-button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 资产列表视图 -->
                        <el-table v-else :data="displayedAssets" @selection-change="handleSelectionChange">
                            <el-table-column type="selection" width="55"></el-table-column>
                            <el-table-column label="预览" width="80">
                                <template slot-scope="scope">
                                    <img v-if="scope.row.type === 'image'" :src="scope.row.thumbnail" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">
                                    <i v-else :class="scope.row.type === 'video' ? 'el-icon-video-camera' : 'el-icon-document'" style="font-size: 32px; color: #909399;"></i>
                                </template>
                            </el-table-column>
                            <el-table-column prop="name" label="名称" min-width="200"></el-table-column>
                            <el-table-column prop="type" label="类型" width="100">
                                <template slot-scope="scope">
                                    <el-tag size="small">{{ scope.row.type }}</el-tag>
                                </template>
                            </el-table-column>
                            <el-table-column prop="size" label="大小" width="100"></el-table-column>
                            <el-table-column prop="usageCount" label="引用次数" width="100"></el-table-column>
                            <el-table-column prop="date" label="上传日期" width="120"></el-table-column>
                            <el-table-column label="操作" width="200" fixed="right">
                                <template slot-scope="scope">
                                    <el-button size="mini" @click="viewAssetDetail(scope.row)">详情</el-button>
                                    <el-button size="mini" @click="copyAssetUrl(scope.row)">复制链接</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                        
                        <!-- 分页 -->
                        <div style="margin-top: 20px; text-align: center;">
                            <el-pagination
                                @current-change="handlePageChange"
                                :current-page="currentPage"
                                :page-size="pageSize"
                                layout="total, prev, pager, next, jumper"
                                :total="totalAssets">
                            </el-pagination>
                        </div>
                    </el-card>
                </div>
            </div>
        </div>
        
        <!-- 上传对话框 -->
        <el-dialog
            title="上传资产"
            :visible.sync="uploadDialogVisible"
            width="600px">
            <div class="upload-area" @click="$refs.fileInput.click()">
                <div class="upload-icon">
                    <i class="el-icon-upload"></i>
                </div>
                <div class="upload-text">点击或拖拽文件到此区域上传</div>
                <div class="upload-tip">支持图片、视频、文档等格式，单个文件不超过100MB</div>
            </div>
            <input ref="fileInput" type="file" style="display:none" multiple @change="handleFileUpload">
            
            <div v-if="uploadFiles.length > 0" style="margin-top: 20px;">
                <h4>待上传文件:</h4>
                <div v-for="(file, index) in uploadFiles" :key="index" style="margin-bottom: 10px;">
                    <el-progress :percentage="file.progress" :status="file.status"></el-progress>
                    <div style="font-size: 12px; color: #606266; margin-top: 5px;">
                        {{ file.name }} ({{ file.size }})
                    </div>
                </div>
            </div>
            
            <span slot="footer" class="dialog-footer">
                <el-button @click="uploadDialogVisible = false">取消</el-button>
                <el-button type="primary" @click="startUpload" :disabled="uploadFiles.length === 0">
                    开始上传
                </el-button>
            </span>
        </el-dialog>
        
        <!-- 资产详情抽屉 -->
        <el-drawer
            :title="currentAsset ? currentAsset.name : '资产详情'"
            :visible.sync="detailDrawerVisible"
            size="50%"
            direction="rtl">
            <div v-if="currentAsset" class="asset-detail-drawer">
                <!-- 预览 -->
                <img 
                    v-if="currentAsset.type === 'image'"
                    :src="currentAsset.url" 
                    class="detail-preview"
                    :alt="currentAsset.name">
                
                <video 
                    v-else-if="currentAsset.type === 'video'"
                    :src="currentAsset.url"
                    class="detail-preview"
                    controls>
                </video>
                
                <!-- 基本信息 -->
                <div class="detail-section">
                    <h3>基本信息</h3>
                    <div class="detail-item">
                        <div class="detail-label">资产ID</div>
                        <div class="detail-value">{{ currentAsset.assetId }}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">文件名</div>
                        <div class="detail-value">{{ currentAsset.name }}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">类型</div>
                        <div class="detail-value">{{ currentAsset.type }}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">大小</div>
                        <div class="detail-value">{{ currentAsset.size }}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">上传时间</div>
                        <div class="detail-value">{{ currentAsset.uploadTime }}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">标签</div>
                        <div class="detail-value">
                            <el-tag 
                                v-for="tag in currentAsset.tags" 
                                :key="tag"
                                size="small"
                                style="margin-right: 5px;">
                                {{ tag }}
                            </el-tag>
                        </div>
                    </div>
                </div>
                
                <!-- 引用地址 -->
                <div class="detail-section">
                    <h3>引用地址</h3>
                    <div class="detail-item">
                        <div class="detail-label">标准URL</div>
                        <div class="url-copy-box">
                            <div class="url-display">{{ currentAsset.url }}</div>
                            <el-button size="small" icon="el-icon-copy-document" @click="copyToClipboard(currentAsset.url)">
                                复制
                            </el-button>
                        </div>
                    </div>
                    <div class="detail-item" v-if="currentAsset.type === 'image'">
                        <div class="detail-label">响应式URL (srcset)</div>
                        <div class="url-copy-box">
                            <div class="url-display">{{ currentAsset.srcset }}</div>
                            <el-button size="small" icon="el-icon-copy-document" @click="copyToClipboard(currentAsset.srcset)">
                                复制
                            </el-button>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">CDN URL</div>
                        <div class="url-copy-box">
                            <div class="url-display">{{ currentAsset.cdnUrl }}</div>
                            <el-button size="small" icon="el-icon-copy-document" @click="copyToClipboard(currentAsset.cdnUrl)">
                                复制
                            </el-button>
                        </div>
                    </div>
                </div>
                
                <!-- 引用页面 -->
                <div class="detail-section">
                    <h3>引用页面 ({{ currentAsset.usageCount }})</h3>
                    <ul class="reference-list">
                        <li v-for="(ref, index) in currentAsset.references" :key="index" class="reference-item">
                            <div class="reference-item-title">{{ ref.pageTitle }}</div>
                            <div class="reference-item-meta">
                                <span>{{ ref.pageUrl }}</span>
                                <span style="margin-left: 15px;">最后修改: {{ ref.lastModified }}</span>
                            </div>
                        </li>
                    </ul>
                    <el-button v-if="currentAsset.usageCount === 0" type="text" disabled>
                        暂无页面引用此资产
                    </el-button>
                </div>
                
                <!-- 版本历史 -->
                <div class="detail-section">
                    <h3>版本历史</h3>
                    <div class="version-timeline">
                        <div v-for="(version, index) in currentAsset.versions" :key="index" class="version-item">
                            <div class="version-dot"></div>
                            <div class="version-content">
                                <div class="version-name">{{ version.name }}</div>
                                <div class="version-info">
                                    <span>{{ version.date }}</span>
                                    <span style="margin-left: 15px;">{{ version.size }}</span>
                                    <span style="margin-left: 15px;">{{ version.changelog }}</span>
                                </div>
                                <el-button size="mini" style="margin-top: 8px;" @click="rollbackVersion(version)">
                                    回滚到此版本
                                </el-button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 操作按钮 -->
                <div class="detail-section">
                    <el-button type="primary" icon="el-icon-edit" @click="editAsset">编辑信息</el-button>
                    <el-button icon="el-icon-download" @click="downloadAsset">下载</el-button>
                    <el-button type="danger" icon="el-icon-delete" @click="deleteAsset">删除</el-button>
                </div>
            </div>
        </el-drawer>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    // 筛选条件
                    filterType: 'all',
                    filterTags: [],
                    dateRange: null,
                    searchKeyword: '',
                    
                    // 视图模式
                    viewMode: 'grid',
                    
                    // 分页
                    currentPage: 1,
                    pageSize: 20,
                    totalAssets: 156,
                    
                    // 选择
                    selectedAssets: [],
                    
                    // 对话框和抽屉
                    uploadDialogVisible: false,
                    detailDrawerVisible: false,
                    
                    // 上传文件
                    uploadFiles: [],
                    
                    // 当前资产
                    currentAsset: null,
                    
                    // 存储统计
                    storageUsed: '8.5 GB',
                    storageTotal: '50 GB',
                    storageUsagePercent: 17,
                    
                    // 资产统计
                    assetStats: {
                        images: 126,
                        videos: 18,
                        documents: 12
                    },
                    
                    // 资产列表
                    assets: [
                        {
                            id: 'asset-001',
                            assetId: 'asset-12345678',
                            name: '物流仓储中心全景图.jpg',
                            type: 'image',
                            size: '2.3 MB',
                            thumbnail: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&q=80',
                            url: 'https://cdn.example.com/assets/12345678/large.jpg',
                            srcset: 'https://cdn.example.com/assets/12345678/large.jpg 2x',
                            cdnUrl: 'https://cdn.example.com/assets/12345678/large.jpg',
                            date: '2024-06-20',
                            uploadTime: '2024-06-20 14:30:00',
                            tags: ['物流', 'Banner', '2024'],
                            usageCount: 15,
                            references: [
                                { pageTitle: '首页', pageUrl: '/home', lastModified: '2024-06-20' },
                                { pageTitle: '关于我们', pageUrl: '/about', lastModified: '2024-06-15' }
                            ],
                            versions: [
                                { name: 'v3 (当前)', date: '2024-06-20', size: '2.3 MB', changelog: '更新为新版本照片' },
                                { name: 'v2', date: '2024-05-15', size: '2.1 MB', changelog: '调整亮度和对比度' },
                                { name: 'v1', date: '2024-03-10', size: '2.5 MB', changelog: '初始版本' }
                            ]
                        },
                        {
                            id: 'asset-002',
                            assetId: 'asset-87654321',
                            name: '自动化分拣系统.jpg',
                            type: 'image',
                            size: '1.8 MB',
                            thumbnail: 'https://images.unsplash.com/photo-1553413077-190dd305871c?w=400&q=80',
                            url: 'https://cdn.example.com/assets/87654321/large.jpg',
                            srcset: 'https://cdn.example.com/assets/87654321/large.jpg 2x',
                            cdnUrl: 'https://cdn.example.com/assets/87654321/large.jpg',
                            date: '2024-06-18',
                            uploadTime: '2024-06-18 10:20:00',
                            tags: ['产品', '物流', '2024'],
                            usageCount: 8,
                            references: [
                                { pageTitle: '产品详情', pageUrl: '/products/automation', lastModified: '2024-06-18' }
                            ],
                            versions: [
                                { name: 'v1 (当前)', date: '2024-06-18', size: '1.8 MB', changelog: '初始版本' }
                            ]
                        },
                        {
                            id: 'asset-003',
                            assetId: 'asset-11223344',
                            name: '企业宣传视频.mp4',
                            type: 'video',
                            size: '45.6 MB',
                            thumbnail: null,
                            url: 'https://cdn.example.com/assets/11223344/video.mp4',
                            cdnUrl: 'https://cdn.example.com/assets/11223344/video.mp4',
                            date: '2024-06-15',
                            uploadTime: '2024-06-15 09:00:00',
                            tags: ['视频', 'Banner', '2024'],
                            usageCount: 3,
                            references: [
                                { pageTitle: '首页', pageUrl: '/home', lastModified: '2024-06-16' }
                            ],
                            versions: [
                                { name: 'v2 (当前)', date: '2024-06-15', size: '45.6 MB', changelog: '压缩优化' },
                                { name: 'v1', date: '2024-06-10', size: '120 MB', changelog: '原始版本' }
                            ]
                        }
                    ]
                }
            },
            computed: {
                displayedAssets() {
                    // 简化版本，实际应该根据筛选条件和分页返回
                    return this.assets;
                },
                storageColor() {
                    if (this.storageUsagePercent < 60) return '#67C23A';
                    if (this.storageUsagePercent < 80) return '#E6A23C';
                    return '#F56C6C';
                }
            },
            methods: {
                applyFilters() {
                    this.$message.success('筛选条件已应用');
                },
                resetFilters() {
                    this.filterType = 'all';
                    this.filterTags = [];
                    this.dateRange = null;
                    this.searchKeyword = '';
                    this.$message.info('筛选条件已重置');
                },
                handleSearch() {
                    this.$message.info(`搜索: ${this.searchKeyword}`);
                },
                toggleSelection(assetId) {
                    const index = this.selectedAssets.indexOf(assetId);
                    if (index > -1) {
                        this.selectedAssets.splice(index, 1);
                    } else {
                        this.selectedAssets.push(assetId);
                    }
                },
                isSelected(assetId) {
                    return this.selectedAssets.includes(assetId);
                },
                clearSelection() {
                    this.selectedAssets = [];
                },
                handleSelectionChange(selection) {
                    this.selectedAssets = selection.map(item => item.id);
                },
                handleBatchAction(command) {
                    if (this.selectedAssets.length === 0) {
                        this.$message.warning('请先选择资产');
                        return;
                    }
                    
                    const actions = {
                        addTags: '批量添加标签',
                        download: '批量下载',
                        delete: '批量删除'
                    };
                    
                    this.$message.success(`${actions[command]}: ${this.selectedAssets.length} 个资产`);
                },
                handlePageChange(page) {
                    this.currentPage = page;
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                },
                viewAssetDetail(asset) {
                    this.currentAsset = asset;
                    this.detailDrawerVisible = true;
                },
                copyAssetUrl(asset) {
                    this.copyToClipboard(asset.url);
                },
                copyToClipboard(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        this.$message.success('链接已复制到剪贴板');
                    }).catch(() => {
                        this.$message.error('复制失败');
                    });
                },
                handleFileUpload(event) {
                    const files = Array.from(event.target.files);
                    this.uploadFiles = files.map(file => ({
                        name: file.name,
                        size: this.formatFileSize(file.size),
                        progress: 0,
                        status: null
                    }));
                },
                startUpload() {
                    // 模拟上传进度
                    this.uploadFiles.forEach((file, index) => {
                        const timer = setInterval(() => {
                            if (file.progress >= 100) {
                                clearInterval(timer);
                                file.status = 'success';
                                if (index === this.uploadFiles.length - 1) {
                                    setTimeout(() => {
                                        this.$message.success('所有文件上传完成');
                                        this.uploadDialogVisible = false;
                                        this.uploadFiles = [];
                                    }, 500);
                                }
                            } else {
                                file.progress += 10;
                            }
                        }, 300);
                    });
                },
                formatFileSize(bytes) {
                    if (bytes < 1024) return bytes + ' B';
                    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
                    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
                },
                editAsset() {
                    this.$message.info('打开编辑对话框');
                },
                downloadAsset() {
                    this.$message.success('开始下载资产');
                },
                deleteAsset() {
                    this.$confirm('确定要删除此资产吗？此操作不可恢复。', '警告', {
                        confirmButtonText: '确定',
                        cancelButtonText: '取消',
                        type: 'warning'
                    }).then(() => {
                        this.$message.success('资产已删除');
                        this.detailDrawerVisible = false;
                    }).catch(() => {});
                },
                rollbackVersion(version) {
                    this.$confirm(`确定要回滚到 ${version.name} 吗？`, '提示', {
                        confirmButtonText: '确定',
                        cancelButtonText: '取消',
                        type: 'warning'
                    }).then(() => {
                        this.$message.success(`已回滚到 ${version.name}`);
                    }).catch(() => {});
                }
            }
        });
    </script>
</body>
</html>
